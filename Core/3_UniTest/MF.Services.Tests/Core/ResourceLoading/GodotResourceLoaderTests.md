# GodotResourceLoader 测试用例文档

## 1. 测试概述

本文档旨在详细说明 `GodotResourceLoader` 类的各项测试用例，确保其功能、边界和异常处理符合预期。`GodotResourceLoader` 负责资源加载、预加载、缓存管理和统计信息跟踪等功能。

## 2. 测试环境

- **测试框架**：xUnit
- **模拟框架**：Moq
- **断言库**：FluentAssertions
- **依赖服务**：IResourceCacheService

## 3. 测试用例

### 3.1 初始化测试

- **用例名称**：构造函数初始化测试
- **测试目的**：验证使用有效的 `IResourceCacheService` 实例化 `GodotResourceLoader` 是否成功
- **前置条件**：`IResourceCacheService` 实例可用
- **测试步骤**：
  1. 创建 `IResourceCacheService` 的模拟实例
  2. 使用该实例创建 `GodotResourceLoader` 实例
- **预期结果**：`GodotResourceLoader` 实例成功创建且不为 null

### 3.2 异步加载资源测试（默认缓存策略）

- **用例名称**：LoadAsync 默认缓存策略测试
- **测试目的**：验证使用默认缓存策略异步加载资源的功能
- **前置条件**：资源路径有效，缓存服务可用
- **测试步骤**：
  1. 设置模拟缓存服务以返回预期资源
  2. 调用 `LoadAsync` 方法加载资源
- **预期结果**：返回与缓存服务中相同的资源实例

### 3.3 异步加载资源测试（无缓存策略）

- **用例名称**：LoadAsync 无缓存策略测试
- **测试目的**：验证使用无缓存策略异步加载资源的功能
- **前置条件**：资源路径有效，缓存服务可用
- **测试步骤**：
  1. 设置模拟缓存服务以返回预期资源
  2. 调用 `LoadAsync` 方法并指定 `CachePolicy.NoCache`
- **预期结果**：返回与缓存服务中相同的资源实例

### 3.4 同步加载资源测试

- **用例名称**：Load 同步加载测试
- **测试目的**：验证同步加载资源的功能
- **前置条件**：资源路径有效，缓存服务可用
- **测试步骤**：
  1. 设置模拟缓存服务以返回预期资源
  2. 调用 `Load` 方法加载资源
- **预期结果**：返回与缓存服务中相同的资源实例

### 3.5 预加载资源测试

- **用例名称**：PreloadAsync 预加载测试
- **测试目的**：验证异步预加载单个资源的功能
- **前置条件**：资源路径有效，缓存服务可用
- **测试步骤**：
  1. 调用 `PreloadAsync` 方法预加载资源
- **预期结果**：方法成功完成，无异常抛出

### 3.6 批量预加载资源测试

- **用例名称**：PreloadBatchAsync 批量预加载测试
- **测试目的**：验证批量预加载多个资源的功能
- **前置条件**：多个资源路径有效
- **测试步骤**：
  1. 准备多个资源路径数组
  2. 调用 `PreloadBatchAsync` 方法预加载资源
- **预期结果**：方法成功完成，无异常抛出

### 3.7 获取统计信息测试

- **用例名称**：GetStatistics 统计信息测试
- **测试目的**：验证获取资源加载统计信息的功能
- **前置条件**：缓存服务可用
- **测试步骤**：
  1. 设置模拟缓存服务以返回预期统计信息
  2. 调用 `GetStatistics` 方法
- **预期结果**：返回与缓存服务中相同的统计信息实例

### 3.8 重置统计信息测试

- **用例名称**：ResetStatistics 重置统计信息测试
- **测试目的**：验证重置资源加载统计信息的功能
- **前置条件**：缓存服务可用
- **测试步骤**：
  1. 调用 `ResetStatistics` 方法
- **预期结果**：缓存服务的 `ResetStatistics` 方法被调用一次

## 4. 测试覆盖率

- **功能测试**：100%（所有核心功能均已覆盖）
- **边界测试**：50%（部分边界条件待补充）
- **异常测试**：75%（主要异常路径已覆盖，部分极端情况待补充）

## 5. 结论

本文档涵盖了 `GodotResourceLoader` 类的主要测试场景。建议在后续工作中增加更多极端情况和异常场景的测试，以进一步提高测试覆盖率。